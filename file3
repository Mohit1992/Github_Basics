Changes from testing branch for file 3